(function(n){n.piroBox_ext=function(t){function p(){n(window).scroll(function(){var t=n(window).height(),r=n(window).width(),f=i.height()-20,e=i.width();i.css({left:r/2-e/2+"px",top:parseInt(n(document).scrollTop())+(t-f)/2+u})})}function a(){if(n(".piro_close").is(":visible")){n(".zoomIn").add(".zoomOut").add(".my_frame").add(".caption").remove();i.add(div_reg).add(resize).stop();t.piro_drag==!0&&i.draggable({disabled:!1});var u=window.navigator.userAgent,f=u.indexOf("MSIE "),r=i;f>0?(r=div_reg.add(piro_bg),n(".div_reg img").remove()):r=i.add(piro_bg);r.piroFadeOut(200,function(){div_reg.html("");piro_loader.hide();piro_nav.hide();piro_bg.add(i).hide().css("visibility","visible")})}}var e,s,c,f,l,r,h,i,u;for(t=jQuery.extend({piro_speed:700,bg_alpha:.9,piro_scroll:!0,piro_drag:null,piro_nav_pos:"top"},t),n.fn.piroFadeIn=function(t,i){n(this).fadeIn(t,function(){var t=window.navigator.userAgent,r=t.indexOf("MSIE ");r>0&&n(this).get(0).style.removeAttribute("filter");i!=undefined&&i()})},n.fn.piroFadeOut=function(t,i){n(this).fadeOut(t,function(){var t=window.navigator.userAgent,r=t.indexOf("MSIE ");r>0&&n(this).get(0).style.removeAttribute("filter");i!=undefined&&i()})},e=n('a[class*="pirobox"]'),s={},r=0;r<e.length;r++)c=n(e[r]),s["a."+c.attr("class").match(/^pirobox_gall\w*/)]=0;f=[];for(l in s)f.push(l);for(r=0;r<f.length;r++)n(f[r]+":first").addClass("first"),n(f[r]+":last").addClass("last");h=n(e);n('a[class*="pirobox_gall"]').each(function(n){this.rev=n+0});n('a[class*="pirobox_gall"]').length==1&&n('a[class*="pirobox_gall"]').each(function(){n(this).addClass("single_fix")});var v='<div class="caption"><\/div>',o=1.203;n("body").append('<div class="piro_overlay"><\/div><table class="piro_html"><tr><td class="h_t_l"><\/td><td class="h_t_c" title="drag me!!"><\/td><td class="h_t_r"><\/td><\/tr><tr><td class="h_c_l"><\/td><td class="h_c_c"><div class="piro_loader" title="close"><span><\/span><\/div><div class="resize"><div class="nav_container"><a href="#prev" class="piro_prev" title="previous"><\/a><a href="#next" class="piro_next" title="next"><\/a><div class="piro_prev_fake">prev<\/div><div class="piro_next_fake">next<\/div><div class="piro_close" title="close"><\/div><\/div><div class="div_reg"><\/div><\/div><\/td><td class="h_c_r"><\/td><\/tr><tr><td class="h_b_l"><\/td><td class="h_b_c"><\/td><td class="h_b_r"><\/td><\/tr><\/table>');i=n(".piro_html");piro_bg=n(".piro_overlay");piro_nav=n(".nav_container");piro_next=n(".piro_next");piro_prev=n(".piro_prev");piro_next_fake=n(".piro_next_fake");piro_prev_fake=n(".piro_prev_fake");piro_close=n(".piro_close");div_reg=n(".div_reg");piro_loader=n(".piro_loader");resize=n(".resize");y=n(window).height();x=n(window).width();piro_nav.hide().css(t.piro_nav_pos,"-38px");t.piro_nav_pos=="top"?u=5:t.piro_nav_pos=="bottom"&&(u=-30);i.css({left:x/2-250+"px",top:parseInt(n(document).scrollTop())+100});n(i).add(piro_bg).hide();piro_bg.css({opacity:t.bg_alpha});n(piro_prev).add(piro_next).bind("click",function(t){piro_nav.hide();n(".caption").remove();n(".zoomIn").add(".zoomOut").remove();t.preventDefault();piro_next.add(piro_prev).hide();var i=parseInt(n('a[class*="pirobox_gall"]').filter(".item").attr("rev")),r=n(this).is(".piro_prev")?n('a[class*="pirobox_gall"]').eq(i-1):n('a[class*="pirobox_gall"]').eq(i+1);r.click()});n("html").bind("keyup",function(t){t.keyCode==27&&(t.preventDefault(),n(piro_close).is(":visible")&&a())});n("html").bind("keyup",function(t){n(".item").is(".first")||(n(".item").attr("data-rel")=="single"?piro_nav.show():t.keyCode==37&&(t.preventDefault(),n(piro_close).is(":visible")&&piro_prev.click()))});n("html").bind("keyup",function(t){n(".item").is(".last")||(n(".item").attr("data-rel")=="single"?piro_nav.show():t.keyCode==39&&(t.preventDefault(),n(piro_close).is(":visible")&&piro_next.click()))});n(window).resize(function(){var t=n(window).height(),r=n(window).width(),f=i.height(),e=i.width();i.css({left:r/2-e/2+"px",top:parseInt(n(document).scrollTop())+(t-f)/2+u})});t.piro_scroll==!0&&p();n(h).each(function(){function s(){function s(){n(".caption").remove();r[1]=="full"&&r[2]=="full"&&(r[2]=n(window).height()-70,r[1]=n(window).width()-55);var f=n(window).height(),e=n(window).width();piro_close.hide();div_reg.add(resize).animate({height:+r[2]+"px",width:+r[1]+"px"},t.piro_speed).css("visibility","visible");i.animate({height:+r[2]+20+"px",width:+r[1]+20+"px",left:e/2-(r[1]/2+10)+"px",top:parseInt(n(document).scrollTop())+(f-r[2])/2+u},t.piro_speed,function(){piro_next.add(piro_prev).add(piro_prev_fake).add(piro_next_fake).css("visibility","visible");piro_nav.show();piro_close.show()})}function h(){piro_nav.add(".caption").hide();e==""?n(".caption").remove():n(v).appendTo(resize);var r=new Image;r.onerror=function(){n(".caption").remove();r.src="http://www.pirolab.it/pirobox/js/error.jpg"};r.onload=function(){var v=r.height,y=r.width,h=n(window).height()-180,c=n(window).width(),f=r.height,s=r.width,l,a,p,w;f+20>h||s+20>c?(l=(s+20)/c,a=(f+20)/h,a>l?(s=Math.round(r.width*(o/a)),f=Math.round(r.height*(o/a))):(s=Math.round(r.width*(o/l)),f=Math.round(r.height*(o/l))),n(".zoomIn").add(".zoomOut").remove(),n(".h_c_c").append('<a href="#" class="zoomIn" title="">zoomIn<\/a>'),n(".zoomIn,.zoomOut").hide()):(f=r.height,s=r.width,n(".zoomIn").add(".zoomOut").remove());h=n(window).height();c=n(window).width();n(r).height(f).width(s).hide();n(".div_reg img").remove();n(".div_reg").html("");div_reg.append(r).show();n(r).addClass("immagine");t.piro_drag==!0&&(n(".immagine,.h_b_c,.h_t_c").css("cursor","move"),p=window.navigator.userAgent,w=p.indexOf("MSIE "),w>0?i.draggable({handle:".h_t_c,.h_b_c,.div_reg img"}):i.draggable({handle:".h_t_c,.h_b_c,.div_reg img",opacity:.8}));div_reg.add(resize).animate({height:f+"px",width:s+"px"},t.piro_speed);i.animate({height:f+20+"px",width:s+20+"px",left:c/2-(s+20)/2+"px",top:parseInt(n(document).scrollTop())+(h-f)/2+u},t.piro_speed,function(){piro_loader.hide();var u=resize.width();n(".caption").css({width:u+"px"});n(".caption").html("<p>"+e+"<\/p>").hide();n(r).fadeIn(300,function(){r.src=="http://www.pirolab.it/pirobox/js/error.jpg";n(window).scroll(function(){n(".zoomOut").is(":visible")&&n(r).animate({width:s,height:f,top:0,left:0},600,function(){n(".immagine").css("cursor","auto");n(r).draggable({disabled:!0});n(".zoomIn").add(".zoomOut").remove();n(".h_c_c").append('<a href="#" class="zoomIn" title="">zoomIn<\/a>')})});n(".zoomOut").on("click",function(u){u.preventDefault();n(".immagine").css("cursor","auto");t.piro_drag==!0&&i.draggable({disabled:!1});n(r).draggable({disabled:!0});n(".zoomIn").add(".zoomOut").remove();n(".h_c_c").append('<a href="#" class="zoomIn" title="">zoomIn<\/a>');n(r).animate({width:s,height:f,top:0,left:0},600)});n(".zoomIn").on("click",function(u){u.preventDefault();n(".zoomIn").add(".zoomOut").remove();n(".h_c_c").append('<a href="#" class="zoomOut" title="">zoomOut<\/a>');n(".zoomOut").show();t.piro_drag==!0&&i.draggable({disabled:!0});n(r).draggable({disabled:!1});n(r).animate({width:y,height:v,top:-(v-f)/2,left:-(y-s)/2},600,function(){var t=div_reg.offset(),i=t.left+s-y,u=t.top+f-v,e=t.left,o=t.top;n(r).draggable({containment:[i,u,e,o],scrollSpeed:400});n(".immagine").css("cursor","move")})});piro_close.show();n(".caption").slideDown(200);piro_next.add(piro_prev).add(piro_prev_fake).add(piro_next_fake).css("visibility","visible");piro_nav.show();resize.resize(function(){NimgW=r.width;NimgH=r.heigh;n(".caption").css({width:NimgW+"px"})})})})};r.src=f;piro_loader.click(function(){r.src="about:blank"})}i.add(piro_bg).add(div_reg).add(piro_loader).show();switch(r[0]){case"iframe":n(".zoomIn").add(".zoomOut").remove();div_reg.html("").css("overflow","hidden");resize.css("overflow","hidden");piro_close.hide();s();div_reg.piroFadeIn(300,function(){div_reg.append('<iframe id="my_frame" class="my_frame" src="'+f+'" frame allowtransparency="true" scrolling="auto" align="top"><\/iframe>');n(".my_frame").css({height:+r[2]+"px",width:+r[1]+"px"});piro_loader.hide()});break;case"content":n(".zoomIn").add(".zoomOut").remove();div_reg.html("").css("overflow","auto");resize.css("overflow","auto");n(".my_frame").remove();piro_close.hide();s();div_reg.piroFadeIn(300,function(){div_reg.load(f);piro_loader.hide()});break;case"inline":n(".zoomIn").add(".zoomOut").remove();div_reg.html("").css("overflow","auto");resize.css("overflow","auto");n(".my_frame").remove();piro_close.hide();s();div_reg.piroFadeIn(300,function(){n(f).clone(!0).appendTo(div_reg).piroFadeIn(300);piro_loader.hide()});break;case"flash":n(".zoomIn").add(".zoomOut").remove();n(".my_frame").remove();div_reg.html("").css("overflow","hidden");s();var c='<object  width="'+r[1]+'" height="'+r[2]+'"><param name="movie" value="'+f+'" /><param name="wmode" value="transparent" /><param name="allowFullScreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="menu" value="false" /><embed src="'+f+'" type="application/x-shockwave-flash" allowscriptaccess="always" menu="false" wmode="transparent" allowfullscreen="true" width="'+r[1]+'" height="'+r[2]+'"><\/embed><\/object>';div_reg.piroFadeIn(300,function(){n(c).appendTo(div_reg);piro_loader.hide()});break;case"gallery":div_reg.css("overflow","hidden");resize.css("overflow","hidden");n(".my_frame").remove();h();break;case"single":n(".my_frame").remove();div_reg.html("").css("overflow","hidden");resize.css("overflow","hidden");h()}}var e=n(this).attr("title"),r=n(this).attr("data-rel").split("-"),f=n(this).attr("href");n(this).unbind();n(this).bind("click",function(i){piro_bg.css({opacity:t.bg_alpha});i.preventDefault();piro_next.add(piro_prev).hide().css("visibility","hidden");n(h).filter(".item").removeClass("item");n(this).addClass("item");s();n(this).is(".first")?(piro_prev.hide(),piro_next.show(),piro_prev_fake.show().css({visibility:"hidden"})):(piro_next.add(piro_prev).show(),piro_next_fake.add(piro_prev_fake).hide());n(this).is(".last")&&(piro_prev.show(),piro_next_fake.show().css({visibility:"hidden"}),piro_next.hide());(n(this).is(".pirobox")||n(this).is(".single_fix"))&&piro_next.add(piro_prev).hide();n(this).is(".last")&&n(this).is(".first")&&piro_next.add(piro_prev).hide()})});n(".immagine").on("click",function(){n(".caption").slideToggle(200)});piro_close.add(piro_loader).add(piro_bg).bind("click",function(n){n.preventDefault();a()})}})(jQuery);
//# sourceMappingURL=pirobox_extended_feb_2011.min.js.map
